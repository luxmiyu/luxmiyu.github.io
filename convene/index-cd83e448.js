(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))a(d);new MutationObserver(d=>{for(const c of d)if(c.type==="childList")for(const o of c.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function n(d){const c={};return d.integrity&&(c.integrity=d.integrity),d.referrerPolicy&&(c.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?c.credentials="include":d.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function a(d){if(d.ep)return;d.ep=!0;const c=n(d);fetch(d.href,c)}})();const C=[{dark:"eaeaea",light:"2a2a2a",name:"text"},{dark:"bababa",light:"5a5a5a",name:"text-secondary"},{dark:"cd435c",light:"e86880",name:"selection"},{dark:"eaeaea",light:"2a2a2a",name:"selection-text"},{dark:"1a1a1a",light:"eaeaea",name:"background"},{dark:"222222",light:"dedede",name:"background-accent"},{dark:"3a3a3a",light:"d2d2d2",name:"shadow"},{dark:"8a8a8a",light:"8a8a8a",name:"hr"},{dark:"2a2a2a",light:"d8d8d8",name:"button"},{dark:"bababa",light:"5a5a5a",name:"button-border"},{dark:"3a3a3a",light:"eaeaea",name:"button-hover"},{dark:"5a5a5a",light:"fafafa",name:"button-active"},{dark:"8a8a8a",light:"fafafa",name:"button-disabled"},{dark:"2a2a2a",light:"d8d8d8",name:"input"},{dark:"5a5a5a",light:"8a8a8a",name:"input-border"},{dark:"eaeaea",light:"5a5a5a",name:"scrollbar-thumb"},{dark:"1a1a1a",light:"eaeaea",name:"scrollbar-track"},{dark:"bababa",light:"eaeaea",name:"range"},{dark:"3a3a3a",light:"aaaaaa",name:"range-border"},{dark:"3a3a3a",light:"aaaaaa",name:"range-background"},{dark:"e26f80",light:"f4899d",name:"checkbox-background"},{dark:"ffeb99",light:"eda425",name:"accent"},{dark:"bae7ea",light:"1ea2ac",name:"stars-3"},{dark:"ce98e9",light:"8a21cd",name:"stars-4"},{dark:"f0c67d",light:"ce7f12",name:"stars-5"},{dark:"3b9100",light:"a1d97b",name:"pity-green"},{dark:"be8508",light:"e3c27c",name:"pity-yellow"},{dark:"a61717",light:"de7272",name:"pity-red"}],L=document.getElementById("theme-toggle");L&&L.addEventListener("click",()=>{_()});document.addEventListener("keydown",e=>{e.altKey&&e.key==="l"&&_()});function _(){localStorage.setItem("theme",localStorage.getItem("theme")==="dark"?"light":"dark"),x()}let D="";function x(){let e=localStorage.getItem("theme")==="light"?"light":"dark";localStorage.setItem("theme",e),L&&(e==="dark"?L.innerHTML="switch to light theme ðŸŒž":L.innerHTML="switch to dark theme ðŸŒš");for(let t in C){let n=C[t].name,a=C[t][e];document.documentElement.style.setProperty(`--color-${n}`,`#${a}`)}D=e}x();setInterval(()=>{D!==localStorage.getItem("theme")&&x()},500);const z=[{rarity:5,type:"character",name:"Verina",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/verina.webp?v=1717436743332"},{rarity:5,type:"character",name:"Encore",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/encore-icon.webp?v=1717437369841"},{rarity:5,type:"character",name:"Jianxin",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/jianxin-icon.webp?v=1717437369430"},{rarity:4,type:"character",name:"Calcharo",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/calcharo-icon.webp?v=1717437369037"},{rarity:5,type:"character",name:"Lingyang",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/lingyang-icon.webp?v=1717437368654"},{rarity:4,type:"character",name:"Aalto",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/aalto-icon.webp?v=1717437367437"},{rarity:4,type:"character",name:"Baizhi",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/baizhi-icon.webp?v=1717437367028"},{rarity:4,type:"character",name:"Chixia",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/chixia-icon.webp?v=1717437366630"},{rarity:4,type:"character",name:"Danjin",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/danjin-icon.webp?v=1717437366246"},{rarity:4,type:"character",name:"Mortefi",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/mortefi-icon.webp?v=1717437365849"},{rarity:5,type:"character",name:"Rover Female",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/rover-female-icon.webp?v=1717437365401"},{rarity:5,type:"character",name:"Rover Male",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/rover-male-icon.webp?v=1717437364993"},{rarity:4,type:"character",name:"Sanhua",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/sanhua-icon.webp?v=1717437364600"},{rarity:4,type:"character",name:"Taoqi",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/taoqi-icon.webp?v=1717437364204"},{rarity:4,type:"character",name:"Yangyang",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/yangyang-icon.webp?v=1717437363794"},{rarity:4,type:"character",name:"Yuanwu",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/yuanwu-icon.webp?v=1717437363302"},{rarity:5,type:"weapon",name:"Abyss Surges",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/abyss-surges-icon.webp?v=1717438945863"},{rarity:4,type:"weapon",name:"Amity Accord",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/amity-accord-icon.webp?v=1717438945514"},{rarity:4,type:"weapon",name:"Augment",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/augment-icon.webp?v=1717438945183"},{rarity:4,type:"weapon",name:"Autumntrace",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/autumntrace-icon.webp?v=1717438944724"},{rarity:3,type:"weapon",name:"Broadblade of Night",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/broadblade-of-night-icon.webp?v=1717438943803"},{rarity:3,type:"weapon",name:"Broadblade of Voyager",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/broadblade-of-voyager-icon.webp?v=1717438943430"},{rarity:4,type:"weapon",name:"Broadblade#41",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/broadblade-41-icon.webp?v=1717438944370"},{rarity:4,type:"weapon",name:"Cadenza",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/cadenza-icon.webp?v=1717438943048"},{rarity:4,type:"weapon",name:"Comet Flare",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/comet-flare-icon.webp?v=1717438942657"},{rarity:4,type:"weapon",name:"Commando of Conviction",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/commando-of-conviction-icon.webp?v=1717438942278"},{rarity:5,type:"weapon",name:"Cosmic Ripples",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/cosmic-ripples-icon.webp?v=1717438941830"},{rarity:4,type:"weapon",name:"Dauntless Evernight",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/dauntless-evernight-icon.webp?v=1717438941495"},{rarity:4,type:"weapon",name:"Discord",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/discord-icon.webp?v=1717438941045"},{rarity:5,type:"weapon",name:"Emerald of Genesis",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/emerald-of-genesis-icon.webp?v=1717438940614"},{rarity:3,type:"weapon",name:"Gauntlets of Night",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/gauntlets-of-night-icon.webp?v=1717438939854"},{rarity:3,type:"weapon",name:"Gauntlets of Voyager",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/gauntlets-of-voyager-icon.webp?v=1717438939453"},{rarity:4,type:"weapon",name:"Gauntlets#21D",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/gauntlets-21d-icon.webp?v=1717438940234"},{rarity:3,type:"weapon",name:"Guardian Broadblade",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/guardian-broadblade-icon.webp?v=1717438939068"},{rarity:3,type:"weapon",name:"Guardian Gauntlets",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/guardian-gauntlets-icon.webp?v=1717438938652"},{rarity:3,type:"weapon",name:"Guardian Pistols",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/guardian-pistols-icon.webp?v=1717438938252"},{rarity:3,type:"weapon",name:"Guardian Rectifier",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/guardian-rectifier-icon.webp?v=1717438937906"},{rarity:3,type:"weapon",name:"Guardian Sword",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/guardian-sword-icon.webp?v=1717438937522"},{rarity:4,type:"weapon",name:"Helios Cleaver",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/helios-cleaver-icon.webp?v=1717438937142"},{rarity:4,type:"weapon",name:"Hollow Mirage",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/hollow-mirage-icon.webp?v=1717438936764"},{rarity:4,type:"weapon",name:"Jinzhou Keeper",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/jinzhou-keeper-icon.webp?v=1717438936271"},{rarity:4,type:"weapon",name:"Lumingloss",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/lumingloss-icon.webp?v=1717438935871"},{rarity:4,type:"weapon",name:"Lunar Cutter",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/lunar-cutter-icon.webp?v=1717438935509"},{rarity:5,type:"weapon",name:"Lustrous Razor",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/lustrous-razor-icon.webp?v=1717438935158"},{rarity:4,type:"weapon",name:"Marcato",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/marcato-icon.webp?v=1717438934820"},{rarity:4,type:"weapon",name:"Novaburst",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/novaburst-icon.webp?v=1717438934417"},{rarity:3,type:"weapon",name:"Originite: Type I",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/originite-type-i-icon.webp?v=1717438934077"},{rarity:3,type:"weapon",name:"Originite: Type II",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/originite-type-ii-icon.webp?v=1717438933676"},{rarity:3,type:"weapon",name:"Originite: Type III",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/originite-type-iii-icon.webp?v=1717438933186"},{rarity:3,type:"weapon",name:"Originite: Type IV",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/originite-type-iv-icon.webp?v=1717438932835"},{rarity:3,type:"weapon",name:"Originite: Type V",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/originite-type-v-icon.webp?v=1717438932456"},{rarity:3,type:"weapon",name:"Pistols of Night",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/pistols-of-night-icon.webp?v=1717438931725"},{rarity:3,type:"weapon",name:"Pistols of Voyager",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/pistols-of-voyager-icon.webp?v=1717438931322"},{rarity:4,type:"weapon",name:"Pistols#26",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/pistols-26-icon.webp?v=1717438932096"},{rarity:3,type:"weapon",name:"Rectifier of Night",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/rectifier-of-night-icon.webp?v=1717438930555"},{rarity:3,type:"weapon",name:"Rectifier of Voyager",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/rectifier-of-voyager-icon.webp?v=1717438930214"},{rarity:3,type:"weapon",name:"Rectifier#25",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/rectifier-25-icon.webp?v=1717438930935"},{rarity:4,type:"weapon",name:"Scale: Slasher",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/scale-slasher-icon.webp?v=1717438929854"},{rarity:5,type:"weapon",name:"Static Mist",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/static-mist-icon.webp?v=1717438929504"},{rarity:4,type:"weapon",name:"Stonard",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/stonard-icon.webp?v=1717438929133"},{rarity:3,type:"weapon",name:"Sword of Night",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/sword-of-night-icon.webp?v=1717438927892"},{rarity:3,type:"weapon",name:"Sword of Voyager",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/sword-of-voyager-icon.webp?v=1717438927514"},{rarity:4,type:"weapon",name:"Sword#18",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/sword-18-icon.webp?v=1717438928353"},{rarity:4,type:"weapon",name:"Thunderbolt",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/thunderbolt-icon.webp?v=1717438927141"},{rarity:3,type:"weapon",name:"Training Broadblade",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/training-broadblade-icon.webp?v=1717438926700"},{rarity:3,type:"weapon",name:"Training Gauntlets",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/training-gauntlets-icon.webp?v=1717438926336"},{rarity:3,type:"weapon",name:"Training Pistols",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/training-pistols-icon.webp?v=1717438925910"},{rarity:3,type:"weapon",name:"Training Rectifier",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/training-rectifier-icon.webp?v=1717438925540"},{rarity:3,type:"weapon",name:"Training Sword",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/training-sword-icon.webp?v=1717438925199"},{rarity:3,type:"weapon",name:"Tyro Broadblade",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/tyro-broadblade-icon.webp?v=1717438924759"},{rarity:3,type:"weapon",name:"Tyro Gauntlets",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/tyro-gauntlets-icon.webp?v=1717438924390"},{rarity:3,type:"weapon",name:"Tyro Pistols",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/tyro-pistols-icon.webp?v=1717438924018"},{rarity:3,type:"weapon",name:"Tyro Rectifier",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/tyro-rectifier-icon.webp?v=1717438923619"},{rarity:3,type:"weapon",name:"Tyro Sword",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/tyro-sword-icon.webp?v=1717438923223"},{rarity:4,type:"weapon",name:"Undying Flame",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/undying-flame-icon.webp?v=1717438922866"},{rarity:4,type:"weapon",name:"Variation",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/variation-icon.webp?v=1717438922507"},{rarity:5,type:"character",name:"Jiyan",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/jiyan-icon.webp?v=1717437368225"},{rarity:5,type:"character",name:"Yinlin",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/yinlin-icon.webp?v=1717437367882"},{rarity:5,type:"weapon",name:"Verdant Summit",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/verdant-summit-icon.webp?v=1717438922137"},{rarity:5,type:"weapon",name:"Stringmaster",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/stringmaster-icon.webp?v=1717438928752"},{rarity:5,type:"character",name:"Jinhsi",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/jinhsi-icon.webp?v=1719920921420"},{rarity:5,type:"weapon",name:"Ages of Harvest",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/ages-of-harvest-icon.webp?v=1719920996838"},{rarity:5,type:"character",name:"Changli",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/changli-icon.webp?v=1721773380624"},{rarity:5,type:"weapon",name:"Blazing Brilliance",url:"https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/blazing-brilliance-icon.webp?v=1721773381117"}];function N(e){var t;return(t=z.find(n=>n.name===e))==null?void 0:t.url}const V="https://gmserver-api.aki-game2.net/gacha/record/query",U="https://aki-gm-resources-oversea.aki-game.net/aki/gacha/index.html#/record",A="https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/wuwa_3star.png?v=1717406925185",q="https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/wuwa_4star.png?v=1717406924374",M="https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/wuwa_5star.png?v=1717406924753",Y="https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/wuwa_astrite.png?v=1717429696954",I="https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/wuwa_lustrous_tide.png?v=1717428693154",K="https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/wuwa_radiant_tide.png?v=1717428692680",Q="https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/wuwa_forging_tide.png?v=1717428693690",W="https://cdn.glitch.global/c075fd5c-154d-425d-adb9-502f0cc7dae0/wuwa_voucher_of_reciprocal_tides.png?v=1717428883493",X=document.getElementById("convene"),S=document.getElementById("import"),y=document.getElementById("dropzone"),Z=document.getElementById("import-profile"),R=document.getElementById("main"),T=document.getElementById("loading"),m=[{id:1,name:"Featured Resonator Convene",currency:K,pulls:[]},{id:2,name:"Featured Weapon Convene",currency:Q,pulls:[]},{id:3,name:"Standard Resonator Convene",currency:I,pulls:[]},{id:4,name:"Standard Weapon Convene",currency:I,pulls:[]},{id:5,name:"Beginner Convene",currency:I,pulls:[]},{id:6,name:"Beginner's Choice Convene",currency:I,pulls:[]},{id:7,name:"Beginner's Choice Convene (Giveback Custom Convene)",currency:W,pulls:[]}];function J(){for(const e of m)e.pulls=[]}X.addEventListener("click",()=>{S.classList.remove("hidden"),b.classList.add("hidden"),v(),R.classList.add("hidden")});let f=JSON.parse(localStorage.getItem("convene.profiles")||"[]");localStorage.setItem("convene.profiles",JSON.stringify(f));const b=document.getElementById("saved");function v(){f=JSON.parse(localStorage.getItem("convene.profiles")||"[]"),localStorage.setItem("convene.profiles",JSON.stringify(f)),b.innerHTML="";const e=document.createElement("h2");e.innerText="Saved Profiles",b.appendChild(e);for(const t of f){const n=document.createElement("div");n.classList.add("profile"),b.appendChild(n);const a=document.createElement("button");a.classList.add("card"),a.innerText=t.name===""?`uid: ${t.playerId}`:`${t.name} - uid: ${t.playerId}`,a.addEventListener("click",()=>{ae(t)}),n.appendChild(a);const d=document.createElement("button");d.innerText="update",d.addEventListener("click",()=>{ne(t)}),n.appendChild(d);const c=document.createElement("button");c.innerText="edit",c.addEventListener("click",()=>{const r=prompt("Enter a name for this profile:",t.name);r!==null&&(t.name=r,localStorage.setItem("convene.profiles",JSON.stringify(f)),v())}),n.appendChild(c);const o=document.createElement("button");o.innerText="export",o.addEventListener("click",()=>{const r=JSON.stringify(t),p=new Date().toISOString().split(".")[0].split("-").join("").split("T").join("_").split(":").join(""),l=`convene_${t.name===""?"":t.name.replace(/[^a-z0-9]/gi,"_").toLowerCase()+"_"}${t.playerId}_${p}.json`,s=new Blob([r],{type:"application/json"}),u=URL.createObjectURL(s),h=document.createElement("a");h.href=u,h.download=l,h.click(),URL.revokeObjectURL(u),console.log(`Exported profile: ${t.name} - uid: ${t.playerId}`)}),n.appendChild(o);const i=document.createElement("button");i.innerText="delete",i.addEventListener("click",()=>{confirm(`Are you sure you want to delete the profile: ${t.name} - uid: ${t.playerId}?`)&&(f=f.filter(p=>p.playerId!==t.playerId),localStorage.setItem("convene.profiles",JSON.stringify(f)),v())}),n.appendChild(i)}f.length===0?b.classList.add("hidden"):b.classList.remove("hidden")}v();function ee(e){const t=new FileReader;t.onload=()=>{console.log(`File read successfully: ${e.name}`);const n=t.result,a=JSON.parse(n);if(f.find(c=>c.playerId===a.playerId)){console.log("A profile with this uid already exists."),alert("A profile with this uid already exists. Please delete the existing profile first.");return}f.push(a),localStorage.setItem("convene.profiles",JSON.stringify(f)),v()},t.readAsText(e)}function te(){const e=document.createElement("input");e.type="file",e.accept=".log",e.onchange=t=>{const n=t.target;if(n.files){const a=n.files[0];ee(a)}},e.click()}Z.addEventListener("click",te);function ae(e){if(console.log(`Loading profile: ${e.name} | uid: ${e.playerId}`),J(),!e.data){console.log("Profile data not found."),alert("Profile data not found. Please update the data first.");return}for(const t of m){const n=e.data.find(a=>a.id===t.id);if(!n){console.log("Banner data not found."),alert("Banner data not found. Please update the data first.");return}t.pulls=[...n.pulls]}H(),G(),S.classList.add("hidden"),b.classList.add("hidden"),R.classList.remove("hidden")}async function ne(e){const t=new Date;console.log(`Loading profile: ${e.name} | uid: ${e.playerId}`),J();function n(a){return{playerId:e.playerId,cardPoolId:"a",cardPoolType:a,serverId:e.serverId,languageCode:"en",recordId:e.recordId}}for(const a of m){console.log(`sending POST request with data: ${JSON.stringify(n(a.id))}`),S.classList.add("hidden"),b.classList.add("hidden"),T.classList.remove("hidden"),T.innerText=`Querying data ${a.id}/${m.length}...`;const c=await(await fetch(V,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n(a.id))})).json();console.log(c);const i=new Date().getTime()-t.getTime();if(console.log(`Response time: ${i}ms`),c.code!==0){console.log("Request failed."),alert("Request failed. Either the account data is wrong or the server is down."),T.classList.add("hidden"),S.classList.remove("hidden"),v();return}e.data||(e.data=[]);const r=e.data.find(s=>s.id===a.id);r&&(a.pulls=[...r.pulls]);const p=[...a.pulls],l=c.data.map(s=>({...s,roll:0,pity:-1})).filter(s=>!p.some(u=>u.time===s.time));console.log(`New pulls: ${l.length}`);for(let s=l.length-1;s>=0;s--){const u=l[s];p.unshift(u)}a.pulls=[...p],localStorage.setItem("convene.profiles",JSON.stringify(f))}for(const a of m){let d=0,c=0,o=0;const i=a.pulls;for(let r=i.length-1;r>=0;r--){d++,c++,o++;const p=i[r].qualityLevel;let g=-1;p===4?(g=c,c=0):p===5&&(g=o,o=0);const l={...i[r],roll:d,pity:g};i[r]=l}}console.log("All requests completed successfully."),H(),G(),e.data=m,localStorage.setItem("convene.profiles",JSON.stringify(f)),T.classList.add("hidden"),b.classList.add("hidden"),R.classList.remove("hidden")}function j(e){const t=new FileReader;t.onload=async()=>{console.log(`File read successfully: ${e.name}`);const a=t.result.split(`
`);let d="";for(const g of a)g.includes(U)&&(d=g);const c=d.split("svr_id=")[1].split("&")[0],o=d.split("player_id=")[1].split("&")[0],i=d.split("record_id=")[1].split("&")[0];if(d===""||c===""||o===""||i===""){console.log("Required data not found."),alert('Required data not found. Are you sure this is a valid "debug.log" file? Make sure to load your convene records first!');return}const r={serverId:c,playerId:o,recordId:i,name:""};if(f.find(g=>g.playerId===r.playerId)){console.log("A profile with this uid already exists."),alert("A profile with this uid already exists. Please delete the existing profile first.");return}f.push(r),localStorage.setItem("convene.profiles",JSON.stringify(f)),v()},t.readAsText(e)}function ce(e){e.preventDefault(),y.classList.remove("dragover");const t=e.dataTransfer;if(!t)return;const n=t.files;if(n.length===0)return;const a=n[0];a.name.endsWith(".log")&&(console.log(`File dropped: ${a.name}`),j(a))}function de(){const e=document.createElement("input");e.type="file",e.accept=".log",e.onchange=t=>{const n=t.target;if(n.files){const a=n.files[0];j(a)}},e.click()}y.addEventListener("dragover",e=>{e.preventDefault(),y.classList.add("dragover")});y.addEventListener("dragleave",()=>{y.classList.remove("dragover")});y.addEventListener("drop",ce);y.addEventListener("click",de);const E=document.getElementById("select-banner");E.innerHTML="";for(const e of m){const t=document.createElement("option");t.value=e.id.toString(),t.innerText=e.name,E.appendChild(t)}function ie(){for(const e of m){const t=document.getElementById(`banner-${e.id}`),n=document.getElementById(`stats-${e.id}`);t.classList.add("hidden"),n.classList.remove("selected")}}function F(){const e=parseInt(E.value),t=document.getElementById(`banner-${e}`),n=document.getElementById(`stats-${e}`);ie(),t.classList.remove("hidden"),n.classList.add("selected")}E.addEventListener("change",F);const O=document.getElementById("stats");function w(e){return`<img src="${e}" alt="currency">`}function H(){O.innerHTML="";for(const e of m){const t=document.createElement("div");t.id=`stats-${e.id}`,t.classList.add("stats"),O.appendChild(t),e.id===1&&t.classList.add("selected");const n=document.createElement("p");n.classList.add("title"),n.innerHTML=`${e.name} <img src="${e.currency}" alt="currency">`,t.appendChild(n);const a=document.createElement("div");a.classList.add("currencies"),t.appendChild(a);const d=document.createElement("p");d.classList.add("currency","stars-0"),d.innerHTML=`${w(e.currency)} ${e.pulls.length}`,a.appendChild(d);const c=document.createElement("p");c.classList.add("currency","stars-0"),c.innerHTML=`${w(Y)} ${e.pulls.length*160}`,a.appendChild(c);const o=document.createElement("p");o.classList.add("currency","stars-5"),o.innerHTML=`${w(M)} ${e.pulls.filter(l=>l.qualityLevel===5).length}`,a.appendChild(o);const i=document.createElement("p");i.classList.add("currency","stars-4"),i.innerHTML=`${w(q)} ${e.pulls.filter(l=>l.qualityLevel===4).length}`,a.appendChild(i);const r=document.createElement("p");r.classList.add("currency","stars-3"),r.innerHTML=`${w(A)} ${e.pulls.filter(l=>l.qualityLevel===3).length}`,a.appendChild(r);const p=document.createElement("div");p.classList.add("overview"),t.appendChild(p);const g=document.createElement("div");g.classList.add("items"),p.appendChild(g);for(const l of e.pulls.filter(s=>s.qualityLevel===5)){const s=document.createElement("div");s.classList.add("item"),g.appendChild(s);const u=document.createElement("img");u.src=N(l.name)||"",u.alt=l.name,s.appendChild(u);const h=document.createElement("p");h.classList.add("pity"),h.innerText=l.pity===-1?"":l.pity.toString(),s.appendChild(h),l.pity<50?h.classList.add("green"):l.pity<70?h.classList.add("yellow"):h.classList.add("red")}t.addEventListener("click",()=>{E.value=e.id.toString(),F()})}}function G(){for(const e of m){const t=document.getElementById(`banner-${e.id}`);t.innerHTML="";for(const n of e.pulls){const a=n.qualityLevel,d=n.resourceType,c=n.name,o=n.time,i=document.createElement("div");i.classList.add("pull",`stars-${a}`),t.appendChild(i);const r=document.createElement("img");r.src=a===3?A:a===4?q:M,r.alt=`${a} stars`,i.appendChild(r);const p=document.createElement("p");p.classList.add("roll"),p.innerText=`#${n.roll}`,i.appendChild(p);const g=document.createElement("p");g.classList.add("resource"),g.innerText=d,i.appendChild(g);const l=document.createElement("img");l.src=N(c)||"",l.alt=c,i.appendChild(l);const s=document.createElement("p");s.classList.add("name"),s.innerText=c,i.appendChild(s);const u=document.createElement("p");u.classList.add("pity"),u.innerText=n.pity===-1?"":n.pity.toString(),i.appendChild(u);const h=document.createElement("p");h.classList.add("time"),h.innerText=o,i.appendChild(h)}}k()}const $=document.getElementById("filter-5"),B=document.getElementById("filter-4"),P=document.getElementById("filter-3");function k(){const e=document.getElementsByClassName("pull"),t=$.classList.contains("active"),n=B.classList.contains("active"),a=P.classList.contains("active");for(let d=0;d<e.length;d++){const c=e[d],o=c.classList.contains("stars-5"),i=c.classList.contains("stars-4"),r=c.classList.contains("stars-3");c.classList.add("hidden"),(t&&o||n&&i||a&&r)&&c.classList.remove("hidden")}}$.addEventListener("click",()=>{$.classList.toggle("active"),k()});B.addEventListener("click",()=>{B.classList.toggle("active"),k()});P.addEventListener("click",()=>{P.classList.toggle("active"),k()});
