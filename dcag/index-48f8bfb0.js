(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const s of l.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&a(s)}).observe(document,{childList:!0,subtree:!0});function n(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerPolicy&&(l.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?l.credentials="include":r.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(r){if(r.ep)return;r.ep=!0;const l=n(r);fetch(r.href,l)}})();const K=[{dark:"eaeaea",light:"2a2a2a",name:"text"},{dark:"bababa",light:"5a5a5a",name:"text-secondary"},{dark:"cd435c",light:"e86880",name:"selection"},{dark:"b6344c",light:"cf4a63",name:"selection-secondary"},{dark:"eaeaea",light:"2a2a2a",name:"selection-text"},{dark:"1a1a1a",light:"eaeaea",name:"background"},{dark:"222222",light:"dedede",name:"background-accent"},{dark:"3a3a3a",light:"d2d2d2",name:"shadow"},{dark:"8a8a8a",light:"8a8a8a",name:"hr"},{dark:"2a2a2a",light:"d8d8d8",name:"button"},{dark:"bababa",light:"5a5a5a",name:"button-border"},{dark:"3a3a3a",light:"eaeaea",name:"button-hover"},{dark:"5a5a5a",light:"fafafa",name:"button-active"},{dark:"8a8a8a",light:"fafafa",name:"button-disabled"},{dark:"2a2a2a",light:"d8d8d8",name:"input"},{dark:"5a5a5a",light:"8a8a8a",name:"input-border"},{dark:"eaeaea",light:"5a5a5a",name:"scrollbar-thumb"},{dark:"1a1a1a",light:"eaeaea",name:"scrollbar-track"},{dark:"bababa",light:"eaeaea",name:"range"},{dark:"3a3a3a",light:"aaaaaa",name:"range-border"},{dark:"3a3a3a",light:"aaaaaa",name:"range-background"},{dark:"cd435c",light:"e86880",name:"bar"},{dark:"b6344c",light:"cf4a63",name:"bar-border"},{dark:"d96379",light:"eb798f",name:"bar-highlight"},{dark:"d75b73",light:"ed7188",name:"bar-hover"},{dark:"ffdae2",light:"22080d",name:"bar-border-hover"}],M=document.getElementById("theme-toggle");M&&M.addEventListener("click",()=>{ye()});document.addEventListener("keydown",e=>{e.altKey&&e.key==="l"&&ye()});function ye(){localStorage.setItem("theme",localStorage.getItem("theme")==="dark"?"light":"dark"),ee()}let ve="";function ee(){let e=localStorage.getItem("theme")==="light"?"light":"dark";localStorage.setItem("theme",e),M&&(e==="dark"?M.innerHTML="switch to light theme ðŸŒž":M.innerHTML="switch to dark theme ðŸŒš");for(let t in K){let n=K[t].name,a=K[t][e];document.documentElement.style.setProperty(`--color-${n}`,`#${a}`)}ve=e}ee();setInterval(()=>{ve!==localStorage.getItem("theme")&&ee()},500);const se=document.querySelector("html"),L=document.querySelector("#display"),c=document.querySelector("#display-image"),ce=document.querySelector("#zoom-icon"),z=document.querySelector("#illustration-title"),R=document.querySelector("#illustration-artist"),be=document.querySelector("#illustration-character"),Le=document.querySelector("#illustration-source"),Se=document.querySelector("#navigation-number"),Te=document.querySelector("#navigation-date"),Be=document.querySelector("#navigation-left-jump"),Pe=document.querySelector("#navigation-left"),Ke=document.querySelector("#navigation-right"),He=document.querySelector("#navigation-right-jump"),Ue=document.querySelector("#button-more"),Ye=document.querySelector("#button-zoom"),Ve=document.querySelector("#button-random"),Ge=document.querySelector("#button-current"),te=document.querySelector("#after"),C=document.querySelector("#share-url"),We=document.querySelector("#share-button"),de=document.querySelector("#share-button-icon"),Ze=document.querySelector("#share-copy"),ue=document.querySelector("#share-copy-icon"),G=document.querySelector("#tab-about"),W=document.querySelector("#tab-calendar"),Z=document.querySelector("#tab-gallery"),J=document.querySelector("#tab-stats"),X=document.querySelector("#tab-search"),me=document.querySelector("#about"),he=document.querySelector("#calendar"),ge=document.querySelector("#gallery"),fe=document.querySelector("#stats"),pe=document.querySelector("#search"),Je=document.querySelector("#calendar-years"),E=document.querySelector("#gallery-images"),we=document.querySelector("#gallery-zoom-range"),Xe=document.querySelector("#stats-timeline-track"),h=document.querySelector("#stats-timeline-from"),g=document.querySelector("#stats-timeline-to"),xe=document.querySelector("#stats-timeline-label-from"),ke=document.querySelector("#stats-timeline-label-to"),Ee=document.querySelector("#stats-timeline-label-from-date"),Ce=document.querySelector("#stats-timeline-label-to-date"),Q=document.querySelector("#stats-size-value"),$=document.querySelector("#stats-size-range"),Qe=document.querySelector("#stats-unknowns-value"),je=document.querySelector("#stats-originals-value"),q=document.querySelector("#stats-artists"),_=document.querySelector("#stats-characters"),D=document.querySelector("#stats-sources"),et=document.querySelector("#search-results"),j=document.querySelector("#search-input"),$e=document.querySelector("#search-count-number"),tt="https://d.luxmiyu.com/dcag.json";let x="about",T={counter:-1,upload_date:"",illustration_id:"",illustration_title:"",artist_id:"",artist_name:"",character:"",source:""};function Ie(e){let t=i[e-1];return t||null}function at(e){return new Date(e.upload_date)}function nt(e){let t=["th","st","nd","rd"],n=e%100;return e+(t[(n-20)%10]||t[n]||t[0])}function rt(e){return`${e.toLocaleDateString("en-US",{month:"long"})} ${nt(e.getDate())}, ${e.getFullYear()}`}function I(e){return rt(at(e)||new Date)}function F(e){return`https://cdn.glitch.global/10390d60-7056-4381-aa7d-a952f8a876e0/thumbnail_${e.illustration_id}.jpg`}function ot(e){return`https://cdn.glitch.global/10390d60-7056-4381-aa7d-a952f8a876e0/full_${e.illustration_id}.jpg`}function lt(){c.classList.add("blurred")}function it(){c.classList.remove("blurred")}function p(e){e>i.length&&(e=i.length),e<1&&(e=1);let t=Ie(e);if(!t)return;T=t,st(),c.src=F(t),lt();let n=`dcag #${e} - ${t.illustration_title} by ${t.artist_name}`;c.alt=n,c.title=n,z.innerText=t.illustration_title,z.href=`https://www.pixiv.net/artworks/${t.illustration_id}`,R.innerText=t.artist_name,R.href=`https://www.pixiv.net/users/${t.artist_id}`,be.innerText=t.character,Le.innerText=t.source,Se.innerText=`#${e}`,Te.innerText=I(t),window.history.replaceState({},document.title,`${window.location.pathname}?n=${e}`),C.value=`https://luxmiyu.com/dcag?n=${e}`,N();let a=new Image;a.src=ot(t),a.addEventListener("load",()=>{T.counter===e&&(c.src=a.src,it(),N())})}function st(){c.src="",c.alt="",c.title="",z.innerText="",z.href="",R.innerText="",R.href="",be.innerText="",Le.innerText="",Se.innerText="",Te.innerText=""}function ae(){let e=Math.floor(Math.random()*i.length);p(e)}function qe(){let e=T.counter+1;e>i.length&&(e=1),p(e)}function _e(){let e=T.counter-1;e<1&&(e=i.length),p(e)}function ct(){p(1)}function De(){p(i.length)}function Me(){let e=T.counter+10;e>i.length&&(e=1),p(e)}function Ae(){let e=T.counter-10;e<1&&(e=i.length),p(e)}Ve.addEventListener("click",ae);Ge.addEventListener("click",De);Be.addEventListener("click",Ae);Pe.addEventListener("click",_e);Ke.addEventListener("click",qe);He.addEventListener("click",Me);Ue.addEventListener("click",()=>{te.scrollIntoView()});const i=[];function dt(e){return typeof e.counter=="number"&&typeof e.upload_date=="string"&&typeof e.illustration_id=="string"&&typeof e.illustration_title=="string"&&typeof e.artist_id=="string"&&typeof e.artist_name=="string"&&typeof e.character=="string"&&typeof e.source=="string"}fetch(tt).then(e=>e.json()).then(e=>{for(let r of e)dt(r)?i.push(r):console.error("invalid illustration",r);console.debug(`loaded ${i.length} illustrations`),console.debug(i[0]);const t=new URLSearchParams(window.location.search),n=t.get("n");if(window.history.replaceState({},document.title,window.location.pathname),n){const r=parseInt(n);isNaN(r)||p(r)}else ae();wt(),xt(),It(),qt();const a=t.get("t");if(a){switch(decodeURIComponent(a)){case"about":x="about";break;case"calendar":x="calendar";break;case"gallery":x="gallery";break;case"stats":x="stats";break;case"search":x="search";break}w(x),te.scrollIntoView()}});function Ne(e){navigator.clipboard.writeText(e)}function ut(){navigator.share?navigator.share({title:T.illustration_title,text:T.illustration_title,url:C.value}):(Ne(C.value),C.select()),de.innerText="check",setTimeout(()=>{de.innerText="share"},1e3)}function mt(){Ne(C.value),C.select(),ue.innerText="check",setTimeout(()=>{ue.innerText="content_copy"},1e3)}We.addEventListener("click",ut);Ze.addEventListener("click",mt);function ze(e,t){c.style.left=`${e}px`,c.style.top=`${t}px`}let S=!1,ne=!1;L.addEventListener("pointerdown",e=>{S&&(ne=!0)});document.addEventListener("pointerup",e=>{ne=!1});document.addEventListener("pointermove",e=>{if(ne&&S){let t={x:e.movementX,y:e.movementY},n={x:parseInt(c.style.left)||0,y:parseInt(c.style.top)||0},a=L.getBoundingClientRect(),r=c.getBoundingClientRect(),l={left:a.left-r.left,right:a.right-r.right,top:a.top-r.top,bottom:a.bottom-r.bottom};t.x=Math.min(l.left,Math.max(l.right,t.x)),t.y=Math.min(l.top,Math.max(l.bottom,t.y)),t.y===0&&(se.style.scrollBehavior="auto",window.scrollBy(0,-e.movementY),se.style.scrollBehavior="smooth"),ze(n.x+t.x,n.y+t.y)}});c.addEventListener("click",e=>{S||window.open(c.src,"_blank")});function ht(){c.style.width="100%",c.style.height="auto"}function gt(){c.style.width="auto",c.style.height="100%"}function N(){ze(0,0);let e=c.naturalWidth/c.naturalHeight,t=L.clientWidth/L.clientHeight;const n=!S&&e>t,a=S&&e<t;n||a?ht():gt()}function Re(){S=!S,S?(L.style.touchAction="none",L.classList.add("zoomed"),ce.innerText="zoom_out",c.draggable=!1):(L.style.touchAction="auto",L.classList.remove("zoomed"),ce.innerText="zoom_in",c.draggable=!0),N()}Ye.addEventListener("click",Re);window.addEventListener("resize",N);N();document.addEventListener("keydown",e=>{document.activeElement instanceof HTMLInputElement||((e.code==="ArrowLeft"||e.code==="KeyA")&&_e(),(e.code==="ArrowRight"||e.code==="KeyD")&&qe(),(e.code==="ArrowUp"||e.code==="KeyW")&&ct(),(e.code==="ArrowDown"||e.code==="KeyS")&&De(),e.code==="KeyQ"&&(e.preventDefault(),Ae()),e.code==="KeyE"&&(e.preventDefault(),Me()),e.code==="KeyZ"&&Re(),e.code==="KeyR"&&ae(),e.code==="KeyF"&&te.scrollIntoView())});function w(e){switch(me.classList.add("hidden"),he.classList.add("hidden"),ge.classList.add("hidden"),fe.classList.add("hidden"),pe.classList.add("hidden"),G.classList.remove("active"),W.classList.remove("active"),Z.classList.remove("active"),J.classList.remove("active"),X.classList.remove("active"),e){case"about":me.classList.remove("hidden"),G.classList.add("active");break;case"calendar":he.classList.remove("hidden"),W.classList.add("active");break;case"gallery":ge.classList.remove("hidden"),Z.classList.add("active");break;case"stats":fe.classList.remove("hidden"),J.classList.add("active");break;case"search":pe.classList.remove("hidden"),X.classList.add("active");break}}G.addEventListener("click",()=>w("about"));W.addEventListener("click",()=>w("calendar"));Z.addEventListener("click",()=>w("gallery"));J.addEventListener("click",()=>w("stats"));X.addEventListener("click",()=>w("search"));w(x);function re(){window.scrollTo(0,0)}function ft(e){let t=0;for(let n=1;n<=12;n++)t+=new Date(e,n,0).getDate();return t}function pt(e,t,n){let a=0;for(let r=2022;r<e;r++)a+=ft(r);for(let r=1;r<t;r++)a+=new Date(e,r,0).getDate();return a+=n,a}function yt(e,t,n){let a=new Date(2022,0,1),r=new Date(a.getTime()+i.length*24*60*60*1e3),l=new Date(e,t-1,n);return l>=a&&l<=r}function vt(e,t){let n=new Date(2022,0,1),a=new Date(n.getTime()+i.length*24*60*60*1e3),r=new Date(e,t-1,1);return r>=n&&r<=a}function bt(e){let t=new Date(2022,0,1),n=new Date(t.getTime()+i.length*24*60*60*1e3);return e>=t.getFullYear()&&e<=n.getFullYear()}function Lt(e){if(e<0||e>6)throw new Error("invalid day index");switch(e){case 0:return"Monday";case 1:return"Tuesday";case 2:return"Wednesday";case 3:return"Thursday";case 4:return"Friday";case 5:return"Saturday";case 6:return"Sunday";default:return""}}function St(e,t){const n=document.querySelector(`#calendar-months-${e}`),a=document.createElement("div");a.classList.add("calendar-month"),a.id=`calendar-month-${e}-${t}`;const r=document.createElement("h3");r.innerText=new Date(e,t-1,1).toLocaleDateString("en-US",{month:"long"});const l=document.createElement("div");l.classList.add("calendar-day-names");for(let u=1;u<=7;u++){const m=document.createElement("p");m.classList.add("calendar-day-name","subtitle"),m.innerText=Lt(u-1).slice(0,3),l.appendChild(m)}const s=document.createElement("div");s.classList.add("calendar-days"),s.id=`calendar-days-${e}-${t}`;let o=new Date(e,t-1,1).getDay()-1;o<0&&(o=6);for(let u=1;u<=o;u++){const m=document.createElement("div");m.classList.add("calendar-day","calendar-day-empty"),s.appendChild(m)}const d=new Date(e,t,0).getDate();for(let u=1;u<=d;u++){if(!yt(e,t,u))continue;const m=pt(e,t,u),k=document.createElement("div");k.classList.add("calendar-day"),k.classList.add("calendar-day-available"),k.addEventListener("click",()=>{p(m),re()});const B=new Image;let le=Ie(m);if(!le)continue;B.src=F(le),B.alt=`dcag #${m-1} - ${i[u+(t-1)*d-1].illustration_title} by ${i[u+(t-1)*d-1].artist_name}`;const P=document.createElement("div");P.classList.add("calendar-hover");const ie=document.createElement("p");ie.innerText=`${u}`,P.appendChild(ie),k.appendChild(B),k.appendChild(P),s.appendChild(k)}a.appendChild(r),a.appendChild(l),a.appendChild(s),n.appendChild(a)}function Tt(e){const t=document.createElement("div");t.classList.add("calendar-year"),t.id=`calendar-year-${e}`;const n=document.createElement("h2");n.innerText=e.toString();const a=document.createElement("div");a.classList.add("calendar-months"),a.id=`calendar-months-${e}`,t.appendChild(n),t.appendChild(a),Je.appendChild(t);for(let r=1;r<=12;r++)vt(e,r)&&St(e,r)}function wt(){let e=2022;for(;bt(e)&&e<2050;)Tt(e),e++}const H=["repeat(auto-fill, minmax(60px, 1fr))","repeat(auto-fill, minmax(80px, 1fr))","repeat(auto-fill, minmax(100px, 1fr))","repeat(auto-fill, minmax(120px, 1fr))","repeat(auto-fill, minmax(140px, 1fr))","repeat(auto-fill, minmax(160px, 1fr))","repeat(auto-fill, minmax(180px, 1fr))"];function Fe(){let e=we.valueAsNumber;e<0&&(e=0),e>=H.length&&(e=H.length-1),e<1?E.classList.add("small-font"):e>4?E.classList.add("large-font"):(E.classList.remove("small-font"),E.classList.remove("large-font")),E.style.gridTemplateColumns=H[e]}function xt(){for(let e of i){let t=document.createElement("div");t.classList.add("gallery-image"),t.addEventListener("click",()=>{p(e.counter),re()});let n=new Image;n.src=F(e),n.alt=`dcag #${e.counter} - ${e.illustration_title} by ${e.artist_name}`,n.id=`gallery-${e.counter}`,n.setAttribute("data-counter",e.counter.toString());let a=document.createElement("div");a.classList.add("gallery-hover");let r=document.createElement("p");r.innerText=`#${e.counter}`,a.appendChild(r),t.appendChild(n),t.appendChild(a),E.appendChild(t)}Fe()}we.addEventListener("input",Fe);const b=[3,6,9,12,24,32,64,128,Number.MAX_SAFE_INTEGER];$.min="0";$.max=(b.length-1).toString();$.value="3";let A=b[parseInt($.value)];Q.innerText=A.toString();const kt=(e,t)=>({id:e,name:t,count:1}),Et=e=>({name:e,count:1}),Ct=e=>({name:e,count:1}),f=[],y=[],v=[];let U=0,Y=0;function V(e,t,n,a,r,l){const s=document.createElement("div");s.classList.add("stat-bar");const o=document.createElement("div");o.classList.add("stat-fill"),o.style.width=`${n/a*100}%`;const d=document.createElement("p");d.classList.add("stat-value"),d.innerText=r;const u=document.createElement("p");u.classList.add("stat-name"),u.innerText=t,o.appendChild(d),o.appendChild(u),s.appendChild(o),s.addEventListener("click",()=>{const m=l??t;j.value=m,Oe(m),w("search")}),e.appendChild(s)}function $t(e){var r,l,s;for(;q.children.length>1;)q.removeChild(q.lastChild);for(;_.children.length>1;)_.removeChild(_.lastChild);for(;D.children.length>1;)D.removeChild(D.lastChild);const t=((r=f[0])==null?void 0:r.count)??0,n=((l=y[0])==null?void 0:l.count)??0,a=((s=v[0])==null?void 0:s.count)??0;for(let o=0;o<Math.min(e,f.length);o++)V(q,f[o].name,f[o].count,t,f[o].count.toString(),f[o].id);for(let o=0;o<Math.min(e,y.length);o++)V(_,y[o].name,y[o].count,n,y[o].count.toString());for(let o=0;o<Math.min(e,v.length);o++)V(D,v[o].name,v[o].count,a,v[o].count.toString());for(let o=f.length;o<Math.min(b[b.length-2],e);o++){const d=document.createElement("div");d.classList.add("empty-bar"),q.appendChild(d)}for(let o=y.length;o<Math.min(b[b.length-2],e);o++){const d=document.createElement("div");d.classList.add("empty-bar"),_.appendChild(d)}for(let o=v.length;o<Math.min(b[b.length-2],e);o++){const d=document.createElement("div");d.classList.add("empty-bar"),D.appendChild(d)}}function O(e,t){e<1&&(e=1),t>i.length&&(t=i.length),f.length=0,y.length=0,v.length=0,U=0,Y=0;for(let n=e;n<=t;n++){const a=i[n-1];let r=f.find(o=>o.id===a.artist_id);if(r?r.count++:f.push(kt(a.artist_id,a.artist_name)),a.character==="-"&&U++,a.source==="Original"&&Y++,a.source==="-"||a.source==="Original")continue;let l=y.find(o=>o.name.toLocaleLowerCase()===a.character.toLocaleLowerCase());l?l.count++:y.push(Et(a.character));let s=v.find(o=>o.name.toLocaleLowerCase()===a.source.toLocaleLowerCase());s?s.count++:v.push(Ct(a.source))}f.sort((n,a)=>n.name.localeCompare(a.name)).sort((n,a)=>a.count-n.count),y.sort((n,a)=>n.name.localeCompare(a.name)).sort((n,a)=>a.count-n.count),v.sort((n,a)=>n.name.localeCompare(a.name)).sort((n,a)=>a.count-n.count),Qe.innerText=U.toString(),je.innerText=Y.toString(),$t(A)}function It(){h.max=i.length.toString(),g.max=i.length.toString(),h.value="1",g.value=i.length.toString(),xe.innerText="#1",ke.innerText=`#${i.length}`,Ee.innerText=I(i[0]),Ce.innerText=I(i[i.length-1]),oe(),O(1,i.length)}function oe(){const e=parseInt(h.value),t=parseInt(g.value),n=i.length,a=e/n*100,r=t/n*100,l="var(--color-range-background)",s="var(--color-range)",o=`calc(${a}% - 8px)`,d=`calc(${r}% + 7px)`;Xe.style.background=`linear-gradient(to right, ${l} ${o}, ${s} ${o}, ${s} ${d}, ${l} ${d}`}h.addEventListener("input",()=>{parseInt(h.value)>parseInt(g.value)&&(h.value=g.value),xe.innerText=`#${h.value}`,Ee.innerText=I(i[parseInt(h.value)-1]),oe(),O(parseInt(h.value),parseInt(g.value))});g.addEventListener("input",()=>{parseInt(g.value)<parseInt(h.value)&&(g.value=h.value),ke.innerText=`#${g.value}`,Ce.innerText=I(i[parseInt(g.value)-1]),oe(),O(parseInt(h.value),parseInt(g.value))});$.addEventListener("input",()=>{A=b[parseInt($.value)],A<Number.MAX_SAFE_INTEGER?Q.innerText=A.toString():Q.innerText="max",O(parseInt(h.value),parseInt(g.value))});function qt(){for(let e of i){let t=document.createElement("div");t.classList.add("search-result"),t.id=`search-${e.counter}`,t.addEventListener("click",()=>{p(e.counter),re()});let n=document.createElement("p");n.innerText=`#${e.counter}`,n.classList.add("search-result-counter");let a=new Image;a.src=F(e),a.alt=`dcag #${e.counter} - ${e.illustration_title} by ${e.artist_name}`;let r=document.createElement("div");r.classList.add("search-result-description");let l=document.createElement("p");l.innerHTML=`<span>${e.illustration_title}</span> by <span>${e.artist_name}</span>`;let s=document.createElement("p");s.innerHTML=`<span>${e.character}</span> from <span>${e.source}</span>`;let o=document.createElement("p");o.classList.add("search-result-date"),o.innerText=I(e),r.appendChild(l),r.appendChild(s),r.appendChild(o),t.appendChild(n),t.appendChild(a),t.appendChild(r),et.appendChild(t)}$e.innerText=i.length.toString()}function Oe(e){let t=e.toLowerCase().split(/ +/),n=0;for(let a of i){let r=document.querySelector(`#search-${a.counter}`),l=`${a.counter} ${a.upload_date} ${a.illustration_id} ${a.illustration_title} ${a.artist_id} ${a.artist_name} ${a.character} ${a.source}`.toLowerCase();r.classList.remove("hidden"),n++;for(let s of t)if(!l.includes(s)){r.classList.add("hidden"),n--;break}}$e.innerText=n.toString()}j.addEventListener("input",()=>{Oe(j.value)});
