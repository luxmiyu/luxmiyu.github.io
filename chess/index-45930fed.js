var K=Object.defineProperty;var M=(t,e,n)=>e in t?K(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var g=(t,e,n)=>(M(t,typeof e!="symbol"?e+"":e,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))r(l);new MutationObserver(l=>{for(const i of l)if(i.type==="childList")for(const d of i.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&r(d)}).observe(document,{childList:!0,subtree:!0});function n(l){const i={};return l.integrity&&(i.integrity=l.integrity),l.referrerPolicy&&(i.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?i.credentials="include":l.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(l){if(l.ep)return;l.ep=!0;const i=n(l);fetch(l.href,i)}})();const p=[{dark:"eaeaea",light:"2a2a2a",name:"text"},{dark:"bababa",light:"5a5a5a",name:"text-secondary"},{dark:"cd435c",light:"e86880",name:"selection"},{dark:"eaeaea",light:"2a2a2a",name:"selection-text"},{dark:"1a1a1a",light:"eaeaea",name:"background"},{dark:"222222",light:"dedede",name:"background-accent"},{dark:"3a3a3a",light:"d2d2d2",name:"shadow"},{dark:"8a8a8a",light:"8a8a8a",name:"hr"},{dark:"2a2a2a",light:"d8d8d8",name:"button"},{dark:"bababa",light:"5a5a5a",name:"button-border"},{dark:"3a3a3a",light:"eaeaea",name:"button-hover"},{dark:"5a5a5a",light:"fafafa",name:"button-active"},{dark:"8a8a8a",light:"fafafa",name:"button-disabled"},{dark:"2a2a2a",light:"d8d8d8",name:"input"},{dark:"5a5a5a",light:"8a8a8a",name:"input-border"},{dark:"eaeaea",light:"5a5a5a",name:"scrollbar-thumb"},{dark:"1a1a1a",light:"eaeaea",name:"scrollbar-track"},{dark:"bababa",light:"eaeaea",name:"range"},{dark:"3a3a3a",light:"aaaaaa",name:"range-border"},{dark:"3a3a3a",light:"aaaaaa",name:"range-background"},{dark:"e26f80",light:"f4899d",name:"checkbox-background"},{dark:"eae3db",light:"eae3db",name:"cell-light"},{dark:"c4b8a8",light:"c4b8a8",name:"cell-dark"},{dark:"ffffff",light:"ffffff",name:"cell-selected"},{dark:"cd435c",light:"cd435c",name:"cell-last-move"}],m=document.getElementById("theme-toggle");m&&m.addEventListener("click",()=>{B()});document.addEventListener("keydown",t=>{t.altKey&&t.key==="l"&&B()});function B(){localStorage.setItem("theme",localStorage.getItem("theme")==="dark"?"light":"dark"),w()}let x="";function w(){let t=localStorage.getItem("theme")==="light"?"light":"dark";localStorage.setItem("theme",t),m&&(t==="dark"?m.innerHTML="switch to light theme ðŸŒž":m.innerHTML="switch to dark theme ðŸŒš");for(let e in p){let n=p[e].name,r=p[e][t];document.documentElement.style.setProperty(`--color-${n}`,`#${r}`)}x=t}w();setInterval(()=>{x!==localStorage.getItem("theme")&&w()},500);var a=(t=>(t.Empty="",t.WhiteKing="wk",t.WhiteQueen="wq",t.WhiteRook="wr",t.WhiteBishop="wb",t.WhiteKnight="wn",t.WhitePawn="wp",t.WhiteDisk="wd",t.BlackKing="bk",t.BlackQueen="bq",t.BlackRook="br",t.BlackBishop="bb",t.BlackKnight="bn",t.BlackPawn="bp",t.BlackDisk="bd",t))(a||{}),f=(t=>(t.Empty="",t.White="w",t.Black="b",t.King="k",t.Queen="q",t.Rook="r",t.Bishop="b",t.Knight="n",t.Pawn="p",t.Disk="d",t))(f||{});class c{constructor(){g(this,"cells",[]);g(this,"lastMove",null);this.clear(),this.setup()}clear(){this.cells=Array(64).fill(""),this.lastMove=null}setup(){this.cells=c.default(),this.lastMove=null}get(e){return this.cells[e.y][e.x]}set(e,n){this.cells[e.y][e.x]=n}move(e,n){e!==n&&(this.set(n,this.get(e)),this.set(e,a.Empty),this.lastMove=[e,n])}export(){return this.cells}import(e){this.cells=e}getColor(e){return c.getColor(this.get(e))}static createRow(e){return Array(8).fill(e)}static default(){return[[a.BlackRook,a.BlackKnight,a.BlackBishop,a.BlackQueen,a.BlackKing,a.BlackBishop,a.BlackKnight,a.BlackRook],c.createRow(a.BlackPawn),c.createRow(a.Empty),c.createRow(a.Empty),c.createRow(a.Empty),c.createRow(a.Empty),c.createRow(a.WhitePawn),[a.WhiteRook,a.WhiteKnight,a.WhiteBishop,a.WhiteQueen,a.WhiteKing,a.WhiteBishop,a.WhiteKnight,a.WhiteRook]]}static getColor(e){return e===a.Empty?f.Empty:e.startsWith("w")?f.White:e.startsWith("b")?f.Black:f.Empty}}class o{constructor(e,n){g(this,"x");g(this,"y");this.x=e,this.y=n,this.clamp()}get id(){return`cell-${this.x}-${this.y}`}clamp(){return this.x=Math.max(0,Math.min(7,this.x)),this.y=Math.max(0,Math.min(7,this.y)),this}toIndex(){return this.y*8+this.x}offset(e){return new o(this.x+e.x,this.y+e.y)}static fromIndex(e){return new o(e%8,Math.floor(e/8))}static validate(e){return e.x<0||e.x>7||e.y<0||e.y>7?null:e}}const h=new c;function L(t){switch(t){case a.WhiteKing:return"https://cdn.glitch.global/e5143343-dba7-4602-8cff-d021bb699e44/white_king.png?v=1717607082435";case a.WhiteQueen:return"https://cdn.glitch.global/e5143343-dba7-4602-8cff-d021bb699e44/white_queen.png?v=1717607083385";case a.WhiteRook:return"https://cdn.glitch.global/e5143343-dba7-4602-8cff-d021bb699e44/white_rook.png?v=1717607083699";case a.WhiteBishop:return"https://cdn.glitch.global/e5143343-dba7-4602-8cff-d021bb699e44/white_bishop_2.png?v=1717617261208";case a.WhiteKnight:return"https://cdn.glitch.global/e5143343-dba7-4602-8cff-d021bb699e44/white_knight.png?v=1717607082756";case a.WhitePawn:return"https://cdn.glitch.global/e5143343-dba7-4602-8cff-d021bb699e44/white_pawn.png?v=1717607083077";case a.WhiteDisk:return"https://cdn.glitch.global/e5143343-dba7-4602-8cff-d021bb699e44/white_disk.png?v=1717607082133";case a.BlackKing:return"https://cdn.glitch.global/e5143343-dba7-4602-8cff-d021bb699e44/black_king.png?v=1717607080219";case a.BlackQueen:return"https://cdn.glitch.global/e5143343-dba7-4602-8cff-d021bb699e44/black_queen.png?v=1717607081178";case a.BlackRook:return"https://cdn.glitch.global/e5143343-dba7-4602-8cff-d021bb699e44/black_rook.png?v=1717607081487";case a.BlackBishop:return"https://cdn.glitch.global/e5143343-dba7-4602-8cff-d021bb699e44/black_bishop_2.png?v=1717617261519";case a.BlackKnight:return"https://cdn.glitch.global/e5143343-dba7-4602-8cff-d021bb699e44/black_knight.png?v=1717607080527";case a.BlackPawn:return"https://cdn.glitch.global/e5143343-dba7-4602-8cff-d021bb699e44/black_pawn.png?v=1717607080837";case a.BlackDisk:return"https://cdn.glitch.global/e5143343-dba7-4602-8cff-d021bb699e44/black_disk.png?v=1717607079929"}return""}const R=document.getElementById("board"),s=document.getElementById("ghost"),D=document.getElementById("ghost-image");for(let t=0;t<8;t++){const e=document.createElement("div");e.classList.add("row"),R.appendChild(e);for(let n=0;n<8;n++){const r=document.createElement("div");r.id=`cell-${n}-${t}`,r.classList.add("cell"),e.appendChild(r),r.setAttribute("data-x",n.toString()),r.setAttribute("data-y",t.toString()),r.addEventListener("pointerdown",W),r.addEventListener("touchstart",C,{passive:!1})}}function k(t){return document.getElementById(t.id)}function b(){for(let t=0;t<8;t++)for(let e=0;e<8;e++){const n=k(new o(t,e)),r=h.get(o.fromIndex(t+e*8));if(n.innerHTML="",n.classList.remove("last-move"),r!==a.Empty){const l=document.createElement("img");l.src=L(r),l.classList.add("piece"),n.appendChild(l),l.addEventListener("dragstart",v),l.addEventListener("touchstart",v)}}if(h.lastMove!==null){const[t,e]=h.lastMove,n=k(t),r=k(e);n.classList.add("last-move"),r.classList.add("last-move")}}s.addEventListener("dragstart",v);let u=null;function v(t){t.preventDefault()}function W(t){t.preventDefault();const e=t.target,n=e.classList.contains("piece")?e.parentElement:e,r=parseInt(n.getAttribute("data-x")),l=parseInt(n.getAttribute("data-y")),i=h.get(new o(r,l));if(i===a.Empty)return;n.innerHTML="",u=new o(r,l);const d=n.getBoundingClientRect();s.style.width=`${d.width}px`,s.style.height=`${d.height}px`,s.classList.add("visible"),D.src=L(i),y(t)}function I(t){t.preventDefault(),s.classList.remove("visible");const n=document.elementsFromPoint(t.clientX,t.clientY).find(i=>i.classList.contains("cell"));if(!n||u===null){b();return}const r=parseInt(n.getAttribute("data-x")),l=parseInt(n.getAttribute("data-y"));h.move(u,new o(r,l)),u=null,b()}function y(t){t.preventDefault();const e=t.clientX,n=t.clientY,r=s.getBoundingClientRect(),l=r.width,i=r.height;s.style.left=`${e-l/2}px`,s.style.top=`${n-i/2}px`}function E(t){return new PointerEvent("pointermove",{clientX:t.clientX,clientY:t.clientY,pointerId:t.identifier,pointerType:"touch"})}function C(t){W(E(t.touches[0])),t.preventDefault()}function $(t){u!==null&&(I(E(t.changedTouches[0])),t.preventDefault())}function A(t){u!==null&&(y(E(t.touches[0])),t.preventDefault())}document.addEventListener("pointermove",y);document.addEventListener("pointerup",I);document.addEventListener("touchmove",A,{passive:!1});document.addEventListener("touchend",$);b();const S=document.getElementById("reset");S.addEventListener("click",()=>{h.setup(),b()});
